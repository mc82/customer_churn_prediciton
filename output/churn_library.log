churn_prediction_logger - INFO - Running churn prediction...
churn_prediction_logger - INFO - Running classifier <class '__main__.RandomForest'> ...
churn_prediction_logger - INFO - Loading data from ./data/bank_data.csv
churn_prediction_logger - INFO - Loading of data has been finished.
churn_prediction_logger - INFO - Describing loaded data:
churn_prediction_logger - INFO - Head of loaded data:
churn_prediction_logger - INFO -    Unnamed: 0  CLIENTNUM     Attrition_Flag  Customer_Age Gender  ...  Total_Amt_Chng_Q4_Q1 Total_Trans_Amt Total_Trans_Ct Total_Ct_Chng_Q4_Q1 Avg_Utilization_Ratio
0           0  768805383  Existing Customer            45      M  ...                 1.335            1144             42               1.625                 0.061
1           1  818770008  Existing Customer            49      F  ...                 1.541            1291             33               3.714                 0.105
2           2  713982108  Existing Customer            51      M  ...                 2.594            1887             20               2.333                 0.000
3           3  769911858  Existing Customer            40      F  ...                 1.405            1171             20               2.333                 0.760
4           4  709106358  Existing Customer            40      M  ...                 2.175             816             28               2.500                 0.000

[5 rows x 22 columns]
churn_prediction_logger - INFO - Shape of loaded data:
churn_prediction_logger - INFO - (10127, 22)
churn_prediction_logger - INFO - Number of None in loaded data:
churn_prediction_logger - INFO - Unnamed: 0                  0
CLIENTNUM                   0
Attrition_Flag              0
Customer_Age                0
Gender                      0
Dependent_count             0
Education_Level             0
Marital_Status              0
Income_Category             0
Card_Category               0
Months_on_book              0
Total_Relationship_Count    0
Months_Inactive_12_mon      0
Contacts_Count_12_mon       0
Credit_Limit                0
Total_Revolving_Bal         0
Avg_Open_To_Buy             0
Total_Amt_Chng_Q4_Q1        0
Total_Trans_Amt             0
Total_Trans_Ct              0
Total_Ct_Chng_Q4_Q1         0
Avg_Utilization_Ratio       0
dtype: int64
churn_prediction_logger - INFO - Basic statistics of loaded data:
churn_prediction_logger - INFO -          Unnamed: 0     CLIENTNUM  Customer_Age  Dependent_count  Months_on_book  ...  Total_Amt_Chng_Q4_Q1  Total_Trans_Amt  Total_Trans_Ct  Total_Ct_Chng_Q4_Q1  Avg_Utilization_Ratio
count  10127.000000  1.012700e+04  10127.000000     10127.000000    10127.000000  ...          10127.000000     10127.000000    10127.000000         10127.000000           10127.000000
mean    5063.000000  7.391776e+08     46.325960         2.346203       35.928409  ...              0.759941      4404.086304       64.858695             0.712222               0.274894
std     2923.557422  3.690378e+07      8.016814         1.298908        7.986416  ...              0.219207      3397.129254       23.472570             0.238086               0.275691
min        0.000000  7.080821e+08     26.000000         0.000000       13.000000  ...              0.000000       510.000000       10.000000             0.000000               0.000000
25%     2531.500000  7.130368e+08     41.000000         1.000000       31.000000  ...              0.631000      2155.500000       45.000000             0.582000               0.023000
50%     5063.000000  7.179264e+08     46.000000         2.000000       36.000000  ...              0.736000      3899.000000       67.000000             0.702000               0.176000
75%     7594.500000  7.731435e+08     52.000000         3.000000       40.000000  ...              0.859000      4741.000000       81.000000             0.818000               0.503000
max    10126.000000  8.283431e+08     73.000000         5.000000       56.000000  ...              3.397000     18484.000000      139.000000             3.714000               0.999000

[8 rows x 16 columns]
churn_prediction_logger - INFO - Setting values of churn column...
churn_prediction_logger - INFO - Setting values of churn column done.
churn_prediction_logger - INFO - Creating EDA plots...
churn_prediction_logger - INFO - Creating histogram of churn column...
churn_prediction_logger - INFO - Creating histogram of churn column done
churn_prediction_logger - INFO - Creating barplot of marital_status column...
churn_prediction_logger - INFO - Creating barplot of marital_status column done.
churn_prediction_logger - INFO - Creating distplot of Total_Trans_Ct column...
churn_prediction_logger - INFO - Creating distplot of Total_Trans_Ct column done.
churn_prediction_logger - INFO - Creating heatmap of of correlated columns...
churn_prediction_logger - INFO - Creating heatmap of of correlated columns done.
churn_prediction_logger - INFO - Encoding some columns...
churn_prediction_logger - INFO - ..encoding Gender
churn_prediction_logger - INFO - ..encoding Education_Level
churn_prediction_logger - INFO - ..encoding Marital_Status
churn_prediction_logger - INFO - ..encoding Income_Category
churn_prediction_logger - INFO - ..encoding Card_Category
churn_prediction_logger - INFO - Encoding some columns is done.
churn_prediction_logger - INFO - Creating new DataFrame with all X columns...
churn_prediction_logger - INFO - Creating new DataFrame with all X columns is done.
churn_prediction_logger - INFO - Head of X data:
churn_prediction_logger - INFO -    Customer_Age  Dependent_count  Months_on_book  Total_Relationship_Count  ...  Education_Level_Churn  Marital_Status_Churn  Income_Category_Churn  Card_Category_Churn
0            45                3              39                         5  ...               0.152012              0.151269               0.134807             0.160979
1            49                5              44                         6  ...               0.155691              0.169414               0.171862             0.160979
2            51                3              36                         4  ...               0.155691              0.151269               0.157655             0.160979
3            40                4              34                         3  ...               0.152012              0.172230               0.171862             0.160979
4            40                3              21                         5  ...               0.159381              0.151269               0.134807             0.160979

[5 rows x 19 columns]
churn_prediction_logger - INFO - Setting churn column as y.
churn_prediction_logger - INFO - Splitting into train and test data...
churn_prediction_logger - INFO - Splitting into train and test data finished.
churn_prediction_logger - INFO - Fitting classifier...
churn_prediction_logger - INFO - Fitting classifier done.
churn_prediction_logger - INFO - Predicting...
churn_prediction_logger - INFO - Predicting training data..
churn_prediction_logger - INFO - Prediction of training data done.
churn_prediction_logger - INFO - Predicting test data..
churn_prediction_logger - INFO - Prediction of test data done.
churn_prediction_logger - INFO - Test classification report:               precision    recall  f1-score   support

           0       0.96      0.99      0.98      2543
           1       0.93      0.80      0.86       496

    accuracy                           0.96      3039
   macro avg       0.95      0.90      0.92      3039
weighted avg       0.96      0.96      0.96      3039

churn_prediction_logger - INFO - Train classification report:               precision    recall  f1-score   support

           0       1.00      1.00      1.00      5957
           1       1.00      1.00      1.00      1131

    accuracy                           1.00      7088
   macro avg       1.00      1.00      1.00      7088
weighted avg       1.00      1.00      1.00      7088

churn_prediction_logger - INFO - Creating ROC curve...
churn_prediction_logger - INFO - Saving model to ...
churn_prediction_logger - INFO - Saving of model done
churn_prediction_logger - INFO - Creating model summary ...
churn_prediction_logger - INFO - Creating model summary done
churn_prediction_logger - INFO - Classification done.
churn_prediction_logger - INFO - Churn prediction with classifier <class '__main__.RandomForest'> has been finished.
churn_prediction_logger - INFO - Running classifier <class '__main__.LogisticRegression'> ...
churn_prediction_logger - INFO - Loading data from ./data/bank_data.csv
churn_prediction_logger - INFO - Loading of data has been finished.
churn_prediction_logger - INFO - Describing loaded data:
churn_prediction_logger - INFO - Head of loaded data:
churn_prediction_logger - INFO -    Unnamed: 0  CLIENTNUM     Attrition_Flag  Customer_Age Gender  ...  Total_Amt_Chng_Q4_Q1 Total_Trans_Amt Total_Trans_Ct Total_Ct_Chng_Q4_Q1 Avg_Utilization_Ratio
0           0  768805383  Existing Customer            45      M  ...                 1.335            1144             42               1.625                 0.061
1           1  818770008  Existing Customer            49      F  ...                 1.541            1291             33               3.714                 0.105
2           2  713982108  Existing Customer            51      M  ...                 2.594            1887             20               2.333                 0.000
3           3  769911858  Existing Customer            40      F  ...                 1.405            1171             20               2.333                 0.760
4           4  709106358  Existing Customer            40      M  ...                 2.175             816             28               2.500                 0.000

[5 rows x 22 columns]
churn_prediction_logger - INFO - Shape of loaded data:
churn_prediction_logger - INFO - (10127, 22)
churn_prediction_logger - INFO - Number of None in loaded data:
churn_prediction_logger - INFO - Unnamed: 0                  0
CLIENTNUM                   0
Attrition_Flag              0
Customer_Age                0
Gender                      0
Dependent_count             0
Education_Level             0
Marital_Status              0
Income_Category             0
Card_Category               0
Months_on_book              0
Total_Relationship_Count    0
Months_Inactive_12_mon      0
Contacts_Count_12_mon       0
Credit_Limit                0
Total_Revolving_Bal         0
Avg_Open_To_Buy             0
Total_Amt_Chng_Q4_Q1        0
Total_Trans_Amt             0
Total_Trans_Ct              0
Total_Ct_Chng_Q4_Q1         0
Avg_Utilization_Ratio       0
dtype: int64
churn_prediction_logger - INFO - Basic statistics of loaded data:
churn_prediction_logger - INFO -          Unnamed: 0     CLIENTNUM  Customer_Age  Dependent_count  Months_on_book  ...  Total_Amt_Chng_Q4_Q1  Total_Trans_Amt  Total_Trans_Ct  Total_Ct_Chng_Q4_Q1  Avg_Utilization_Ratio
count  10127.000000  1.012700e+04  10127.000000     10127.000000    10127.000000  ...          10127.000000     10127.000000    10127.000000         10127.000000           10127.000000
mean    5063.000000  7.391776e+08     46.325960         2.346203       35.928409  ...              0.759941      4404.086304       64.858695             0.712222               0.274894
std     2923.557422  3.690378e+07      8.016814         1.298908        7.986416  ...              0.219207      3397.129254       23.472570             0.238086               0.275691
min        0.000000  7.080821e+08     26.000000         0.000000       13.000000  ...              0.000000       510.000000       10.000000             0.000000               0.000000
25%     2531.500000  7.130368e+08     41.000000         1.000000       31.000000  ...              0.631000      2155.500000       45.000000             0.582000               0.023000
50%     5063.000000  7.179264e+08     46.000000         2.000000       36.000000  ...              0.736000      3899.000000       67.000000             0.702000               0.176000
75%     7594.500000  7.731435e+08     52.000000         3.000000       40.000000  ...              0.859000      4741.000000       81.000000             0.818000               0.503000
max    10126.000000  8.283431e+08     73.000000         5.000000       56.000000  ...              3.397000     18484.000000      139.000000             3.714000               0.999000

[8 rows x 16 columns]
churn_prediction_logger - INFO - Setting values of churn column...
churn_prediction_logger - INFO - Setting values of churn column done.
churn_prediction_logger - INFO - Creating EDA plots...
churn_prediction_logger - INFO - Creating histogram of churn column...
churn_prediction_logger - INFO - Creating histogram of churn column done
churn_prediction_logger - INFO - Creating barplot of marital_status column...
churn_prediction_logger - INFO - Creating barplot of marital_status column done.
churn_prediction_logger - INFO - Creating distplot of Total_Trans_Ct column...
churn_prediction_logger - INFO - Creating distplot of Total_Trans_Ct column done.
churn_prediction_logger - INFO - Creating heatmap of of correlated columns...
churn_prediction_logger - INFO - Creating heatmap of of correlated columns done.
churn_prediction_logger - INFO - Encoding some columns...
churn_prediction_logger - INFO - ..encoding Gender
churn_prediction_logger - INFO - ..encoding Education_Level
churn_prediction_logger - INFO - ..encoding Marital_Status
churn_prediction_logger - INFO - ..encoding Income_Category
churn_prediction_logger - INFO - ..encoding Card_Category
churn_prediction_logger - INFO - Encoding some columns is done.
churn_prediction_logger - INFO - Creating new DataFrame with all X columns...
churn_prediction_logger - INFO - Creating new DataFrame with all X columns is done.
churn_prediction_logger - INFO - Head of X data:
churn_prediction_logger - INFO -    Customer_Age  Dependent_count  Months_on_book  Total_Relationship_Count  ...  Education_Level_Churn  Marital_Status_Churn  Income_Category_Churn  Card_Category_Churn
0            45                3              39                         5  ...               0.152012              0.151269               0.134807             0.160979
1            49                5              44                         6  ...               0.155691              0.169414               0.171862             0.160979
2            51                3              36                         4  ...               0.155691              0.151269               0.157655             0.160979
3            40                4              34                         3  ...               0.152012              0.172230               0.171862             0.160979
4            40                3              21                         5  ...               0.159381              0.151269               0.134807             0.160979

[5 rows x 19 columns]
churn_prediction_logger - INFO - Setting churn column as y.
churn_prediction_logger - INFO - Splitting into train and test data...
churn_prediction_logger - INFO - Splitting into train and test data finished.
churn_prediction_logger - INFO - Fitting classifier...
churn_prediction_logger - INFO - Fitting classifier done.
churn_prediction_logger - INFO - Predicting...
churn_prediction_logger - INFO - Predicting training data..
churn_prediction_logger - INFO - Prediction of training data done.
churn_prediction_logger - INFO - Predicting test data..
churn_prediction_logger - INFO - Prediction of test data done.
churn_prediction_logger - INFO - Test classification report:               precision    recall  f1-score   support

           0       0.90      0.96      0.93      2543
           1       0.71      0.47      0.56       496

    accuracy                           0.88      3039
   macro avg       0.80      0.71      0.75      3039
weighted avg       0.87      0.88      0.87      3039

churn_prediction_logger - INFO - Train classification report:               precision    recall  f1-score   support

           0       0.91      0.96      0.93      5957
           1       0.71      0.50      0.58      1131

    accuracy                           0.89      7088
   macro avg       0.81      0.73      0.76      7088
weighted avg       0.88      0.89      0.88      7088

churn_prediction_logger - INFO - Creating ROC curve...
churn_prediction_logger - INFO - Saving model to ...
churn_prediction_logger - INFO - Saving of model done
churn_prediction_logger - INFO - Creating model summary ...
churn_prediction_logger - INFO - Creating model summary done
churn_prediction_logger - INFO - Classification done.
churn_prediction_logger - INFO - Churn prediction with classifier <class '__main__.LogisticRegression'> has been finished.
churn_prediction_logger - INFO - Churn prediction has been finished.
churn_prediction_logger - INFO - Testing {__name__}
churn_prediction_logger - INFO - Testing test_fit_logistic_regression: SUCCESS
churn_prediction_logger - INFO - Testing test_fit_logistic_regression: SUCCESS
churn_prediction_logger - INFO - Testing test_load_logistic_regression: SUCCESS
churn_prediction_logger - INFO - Testing test_save_logistic_regression: SUCCESS
churn_prediction_logger - INFO - Testing test_predict_logistic_regression: SUCCESS
churn_prediction_logger - INFO - Testing test_fit_and_save_random_forest: SUCCESS
churn_prediction_logger - INFO - Testing test_predict_random_forest: SUCCESS
churn_prediction_logger - INFO - Testing test_create_bar_plot: SUCCESS
churn_prediction_logger - INFO - Testing test_create_dist_plot: SUCCESS
churn_prediction_logger - INFO - Testing test_create_feature_importance_plot: SUCCESS
churn_prediction_logger - INFO - Testing test_create_heatmap: SUCCESS
churn_prediction_logger - INFO - Testing test_create_hist: SUCCESS
churn_prediction_logger - INFO - Testing test_create_model_summary_plot: SUCCESS
churn_prediction_logger - INFO - Testing test_create_roc_curve: SUCCESS
churn_prediction_logger - INFO - Testing test_create_shap_plot: SUCCESS
churn_prediction_logger - INFO - Testing test_register_one_classifier: SUCCESS
churn_prediction_logger - INFO - Testing test_register_one_classifier: SUCCESS
churn_prediction_logger - INFO - Testing test_register_both_classifiers: SUCCESS
churn_prediction_logger - INFO - Testing test_path_exists: SUCCESS
churn_prediction_logger - INFO - Testing test_path_not_exists: SUCCESS
